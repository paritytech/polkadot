<!DOCTYPE html><html lang="en"><head><link rel="canonical" href="https://paritytech.github.io/polkadot-sdk/master/polkadot_node_subsystem_util/index.html"><meta http-equiv="refresh" content="0;URL='https://paritytech.github.io/polkadot-sdk/master/polkadot_node_subsystem_util/index.html'"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Utility module for subsystems"><title>polkadot_node_subsystem_util - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="polkadot_node_subsystem_util" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../polkadot_node_subsystem_util/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../polkadot_node_subsystem_util/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate polkadot_node_subsystem_util</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.9.43</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">polkadot_node_subsystem_util</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/polkadot_node_subsystem_util/lib.rs.html#17-442">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Utility module for subsystems</p>
<p>Many subsystems have common interests such as canceling a bunch of spawned jobs,
or determining what their validator ID is. These common interests are factored into
this module.</p>
<p>This crate also reexports Prometheus metric types which are expected to be implemented by
subsystems.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.rand"><code>pub use <a class="mod" href="https://rust-random.github.io/rand/rand/index.html" title="mod rand">rand</a>;</code></div></li><li><div class="item-name" id="reexport.metered"><code>pub use metered;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="backing_implicit_view/index.html" title="mod polkadot_node_subsystem_util::backing_implicit_view">backing_implicit_view</a></div><div class="desc docblock-short">A utility for managing the implicit view of the relay-chain derived from active
leaves and the minimum allowed relay-parents that parachain candidates can have
and be backed in those leaves’ children.</div></li><li><div class="item-name"><a class="mod" href="database/index.html" title="mod polkadot_node_subsystem_util::database">database</a></div><div class="desc docblock-short">Database trait for subsystem.
Database trait for polkadot db.</div></li><li><div class="item-name"><a class="mod" href="inclusion_emulator/index.html" title="mod polkadot_node_subsystem_util::inclusion_emulator">inclusion_emulator</a></div><div class="desc docblock-short">An emulator for node-side code to predict the results of on-chain parachain inclusion
and predict future constraints.</div></li><li><div class="item-name"><a class="mod" href="metrics/index.html" title="mod polkadot_node_subsystem_util::metrics">metrics</a></div><div class="desc docblock-short">This module reexports Prometheus types and defines the <a href="metrics/trait.Metrics.html" title="trait polkadot_node_subsystem_util::metrics::Metrics"><code>Metrics</code></a> trait.</div></li><li><div class="item-name"><a class="mod" href="nesting_sender/index.html" title="mod polkadot_node_subsystem_util::nesting_sender">nesting_sender</a></div><div class="desc docblock-short">Nested message sending</div></li><li><div class="item-name"><a class="mod" href="reexports/index.html" title="mod polkadot_node_subsystem_util::reexports">reexports</a></div><div class="desc docblock-short">These reexports are required so that external crates can use the <code>delegated_subsystem</code> macro
properly.</div></li><li><div class="item-name"><a class="mod" href="reputation/index.html" title="mod polkadot_node_subsystem_util::reputation">reputation</a></div><div class="desc docblock-short">A utility abstraction to collect and send reputation changes.</div></li><li><div class="item-name"><a class="mod" href="runtime/index.html" title="mod polkadot_node_subsystem_util::runtime">runtime</a></div><div class="desc docblock-short">Convenient and efficient runtime info access.
Convenient interface to runtime information.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Metronome.html" title="struct polkadot_node_subsystem_util::Metronome">Metronome</a></div><div class="desc docblock-short">Create a stream of ticks with a defined cycle duration.</div></li><li><div class="item-name"><a class="struct" href="struct.Timeout.html" title="struct polkadot_node_subsystem_util::Timeout">Timeout</a></div><div class="desc docblock-short">A future that wraps another future with a <code>Delay</code> allowing for time-limited futures.</div></li><li><div class="item-name"><a class="struct" href="struct.Validator.html" title="struct polkadot_node_subsystem_util::Validator">Validator</a></div><div class="desc docblock-short">Local validator information</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Error.html" title="enum polkadot_node_subsystem_util::Error">Error</a></div><div class="desc docblock-short">Utility errors</div></li><li><div class="item-name"><a class="enum" href="enum.OverseerError.html" title="enum polkadot_node_subsystem_util::OverseerError">OverseerError</a></div><div class="desc docblock-short">An error type that describes faults that may happen</div></li></ul><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.JOB_CHANNEL_CAPACITY.html" title="constant polkadot_node_subsystem_util::JOB_CHANNEL_CAPACITY">JOB_CHANNEL_CAPACITY</a></div><div class="desc docblock-short">Capacity of channels to and from individual jobs</div></li><li><div class="item-name"><a class="constant" href="constant.JOB_GRACEFUL_STOP_DURATION.html" title="constant polkadot_node_subsystem_util::JOB_GRACEFUL_STOP_DURATION">JOB_GRACEFUL_STOP_DURATION</a></div><div class="desc docblock-short">Duration a job will wait after sending a stop signal before hard-aborting.</div></li><li><div class="item-name"><a class="constant" href="constant.MIN_GOSSIP_PEERS.html" title="constant polkadot_node_subsystem_util::MIN_GOSSIP_PEERS">MIN_GOSSIP_PEERS</a></div><div class="desc docblock-short">The minimum amount of peers to send gossip messages to.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Subsystem.html" title="trait polkadot_node_subsystem_util::Subsystem">Subsystem</a></div><div class="desc docblock-short">A trait that describes the <a href="trait.Subsystem.html"><code>Subsystem</code></a>s that can run on the <a href="struct.Orchestra.html"><code>Orchestra</code></a>.</div></li><li><div class="item-name"><a class="trait" href="trait.TimeoutExt.html" title="trait polkadot_node_subsystem_util::TimeoutExt">TimeoutExt</a></div><div class="desc docblock-short">Extends <code>Future</code> to allow time-limited futures.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.choose_random_subset.html" title="fn polkadot_node_subsystem_util::choose_random_subset">choose_random_subset</a></div><div class="desc docblock-short">Choose a random subset of <code>min</code> elements.
But always include <code>is_priority</code> elements.</div></li><li><div class="item-name"><a class="fn" href="fn.choose_random_subset_with_rng.html" title="fn polkadot_node_subsystem_util::choose_random_subset_with_rng">choose_random_subset_with_rng</a></div><div class="desc docblock-short">Choose a random subset of <code>min</code> elements using a specific Random Generator <code>Rng</code>
But always include <code>is_priority</code> elements.</div></li><li><div class="item-name"><a class="fn" href="fn.determine_new_blocks.html" title="fn polkadot_node_subsystem_util::determine_new_blocks">determine_new_blocks</a></div><div class="desc docblock-short">Given a new chain-head hash, this determines the hashes of all new blocks we should track
metadata for, given this head.</div></li><li><div class="item-name"><a class="fn" href="fn.executor_params_at_relay_parent.html" title="fn polkadot_node_subsystem_util::executor_params_at_relay_parent">executor_params_at_relay_parent</a></div><div class="desc docblock-short">Requests executor parameters from the runtime effective at given relay-parent. First obtains
session index at the relay-parent, relying on the fact that it should be cached by the runtime
API caching layer even if the block itself has already been pruned. Then requests executor
parameters by session index.
Returns an error if failed to communicate to the runtime, or the parameters are not in the
storage, which should never happen.
Returns default execution parameters if the runtime doesn’t yet support <code>SessionExecutorParams</code>
API call.
Otherwise, returns execution parameters returned by the runtime.</div></li><li><div class="item-name"><a class="fn" href="fn.find_validator_group.html" title="fn polkadot_node_subsystem_util::find_validator_group">find_validator_group</a></div><div class="desc docblock-short">Find the validator group the given validator index belongs to.</div></li><li><div class="item-name"><a class="fn" href="fn.gen_ratio.html" title="fn polkadot_node_subsystem_util::gen_ratio">gen_ratio</a></div><div class="desc docblock-short">Returns a <code>bool</code> with a probability of <code>a / b</code> of being true.</div></li><li><div class="item-name"><a class="fn" href="fn.gen_ratio_rng.html" title="fn polkadot_node_subsystem_util::gen_ratio_rng">gen_ratio_rng</a></div><div class="desc docblock-short">Returns a <code>bool</code> with a probability of <code>a / b</code> of being true.</div></li><li><div class="item-name"><a class="fn" href="fn.request_assumed_validation_data.html" title="fn polkadot_node_subsystem_util::request_assumed_validation_data">request_assumed_validation_data</a></div><div class="desc docblock-short">Request <code>AssumedValidationData</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_authorities.html" title="fn polkadot_node_subsystem_util::request_authorities">request_authorities</a></div><div class="desc docblock-short">Request <code>Authorities</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_availability_cores.html" title="fn polkadot_node_subsystem_util::request_availability_cores">request_availability_cores</a></div><div class="desc docblock-short">Request <code>AvailabilityCores</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_candidate_events.html" title="fn polkadot_node_subsystem_util::request_candidate_events">request_candidate_events</a></div><div class="desc docblock-short">Request <code>CandidateEvents</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_candidate_pending_availability.html" title="fn polkadot_node_subsystem_util::request_candidate_pending_availability">request_candidate_pending_availability</a></div><div class="desc docblock-short">Request <code>CandidatePendingAvailability</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_from_runtime.html" title="fn polkadot_node_subsystem_util::request_from_runtime">request_from_runtime</a></div><div class="desc docblock-short">Request some data from the <code>RuntimeApi</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.request_key_ownership_proof.html" title="fn polkadot_node_subsystem_util::request_key_ownership_proof">request_key_ownership_proof</a></div><div class="desc docblock-short">Request <code>KeyOwnershipProof</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_on_chain_votes.html" title="fn polkadot_node_subsystem_util::request_on_chain_votes">request_on_chain_votes</a></div><div class="desc docblock-short">Request <code>FetchOnChainVotes</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_persisted_validation_data.html" title="fn polkadot_node_subsystem_util::request_persisted_validation_data">request_persisted_validation_data</a></div><div class="desc docblock-short">Request <code>PersistedValidationData</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_runtime_api_version.html" title="fn polkadot_node_subsystem_util::request_runtime_api_version">request_runtime_api_version</a></div><div class="desc docblock-short">Request <code>Version</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_session_executor_params.html" title="fn polkadot_node_subsystem_util::request_session_executor_params">request_session_executor_params</a></div><div class="desc docblock-short">Request <code>SessionExecutorParams</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_session_index_for_child.html" title="fn polkadot_node_subsystem_util::request_session_index_for_child">request_session_index_for_child</a></div><div class="desc docblock-short">Request <code>SessionIndexForChild</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_session_info.html" title="fn polkadot_node_subsystem_util::request_session_info">request_session_info</a></div><div class="desc docblock-short">Request <code>SessionInfo</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_staging_async_backing_params.html" title="fn polkadot_node_subsystem_util::request_staging_async_backing_params">request_staging_async_backing_params</a></div><div class="desc docblock-short">Request <code>StagingAsyncBackingParams</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_submit_report_dispute_lost.html" title="fn polkadot_node_subsystem_util::request_submit_report_dispute_lost">request_submit_report_dispute_lost</a></div><div class="desc docblock-short">Request <code>SubmitReportDisputeLost</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_unapplied_slashes.html" title="fn polkadot_node_subsystem_util::request_unapplied_slashes">request_unapplied_slashes</a></div><div class="desc docblock-short">Request <code>UnappliedSlashes</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_validation_code.html" title="fn polkadot_node_subsystem_util::request_validation_code">request_validation_code</a></div><div class="desc docblock-short">Request <code>ValidationCode</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_validation_code_by_hash.html" title="fn polkadot_node_subsystem_util::request_validation_code_by_hash">request_validation_code_by_hash</a></div><div class="desc docblock-short">Request <code>ValidationCodeByHash</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_validation_code_hash.html" title="fn polkadot_node_subsystem_util::request_validation_code_hash">request_validation_code_hash</a></div><div class="desc docblock-short">Request <code>ValidationCodeHash</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_validator_groups.html" title="fn polkadot_node_subsystem_util::request_validator_groups">request_validator_groups</a></div><div class="desc docblock-short">Request <code>ValidatorGroups</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.request_validators.html" title="fn polkadot_node_subsystem_util::request_validators">request_validators</a></div><div class="desc docblock-short">Request <code>Validators</code> from the runtime</div></li><li><div class="item-name"><a class="fn" href="fn.sign.html" title="fn polkadot_node_subsystem_util::sign">sign</a></div><div class="desc docblock-short">Sign the given data with the given validator ID.</div></li><li><div class="item-name"><a class="fn" href="fn.signing_key.html" title="fn polkadot_node_subsystem_util::signing_key">signing_key</a></div><div class="desc docblock-short">From the given set of validators, find the first key we can sign with, if any.</div></li><li><div class="item-name"><a class="fn" href="fn.signing_key_and_index.html" title="fn polkadot_node_subsystem_util::signing_key_and_index">signing_key_and_index</a></div><div class="desc docblock-short">From the given set of validators, find the first key we can sign with, if any, and return it
along with the validator index.</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.RuntimeApiReceiver.html" title="type polkadot_node_subsystem_util::RuntimeApiReceiver">RuntimeApiReceiver</a></div><div class="desc docblock-short">A type alias for Runtime API receivers.</div></li></ul></section></div></main></body></html>