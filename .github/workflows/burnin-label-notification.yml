name: Notify devops when burn-in label applied
on:
  pull_request:
    types: [labeled]

jobs:
  notify-devops:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        channel:
          - name: "Help Desk: Infrastructure (DevOps)"
            room: '!IQAaaFnRIrFutzzaql:parity.io'

    steps:
      - name: Send Matrix message to ${{ matrix.channel.name }}
        if: github.event.label.name == 'A1-needsburnin'
        uses: s3krit/matrix-message-action@70ad3fb812ee0e45ff8999d6af11cafad11a6ecf # v0.0.3
        with:
          room_id: ${{ matrix.channel.room }}
          access_token: ${{ secrets.POLKADOT_DEVOPS_MATRIX_ACCESS_TOKEN }}
          server: m.parity.io
          message: |
            @room Burn-in request received for the following PR: ${{ github.event.pull_request.html_url }}
